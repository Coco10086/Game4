var __extends=this&&this.__extends||function(){var extendStatics=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(d,b){d.__proto__=b}||function(d,b){for(var p in b)b.hasOwnProperty(p)&&(d[p]=b[p])};return function(d,b){function __(){this.constructor=d}extendStatics(d,b),d.prototype=null===b?Object.create(b):(__.prototype=b.prototype,new __)}}();!function(){return function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){return o(e[i][1][r]||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}}()({1:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var GameUI_1=require("./script/GameUI"),MessageView_1=require("./script/MessageView"),GameControl_1=require("./script/GameControl"),ItemBox_1=require("./script/ItemBox"),GameConfig=function(){function GameConfig(){}return GameConfig.init=function(){var reg=Laya.ClassUtils.regClass;reg("script/GameUI.ts",GameUI_1.default),reg("script/MessageView.ts",MessageView_1.default),reg("script/GameControl.ts",GameControl_1.default),reg("script/ItemBox.ts",ItemBox_1.default)},GameConfig.width=640,GameConfig.height=1136,GameConfig.scaleMode="fixedwidth",GameConfig.screenMode="none",GameConfig.alignV="top",GameConfig.alignH="left",GameConfig.startScene="test/TestScene.scene",GameConfig.sceneRoot="",GameConfig.debug=!1,GameConfig.stat=!1,GameConfig.physicsDebug=!1,GameConfig.exportSceneToJson=!0,GameConfig}();exports.default=GameConfig,GameConfig.init()},{"./script/GameControl":3,"./script/GameUI":4,"./script/ItemBox":5,"./script/MessageView":6}],2:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var GameConfig_1=require("./GameConfig");new(function(){function Main(){window.Laya3D?Laya3D.init(GameConfig_1.default.width,GameConfig_1.default.height):Laya.init(GameConfig_1.default.width,GameConfig_1.default.height,Laya.WebGL),Laya.Physics&&Laya.Physics.enable(),Laya.DebugPanel&&Laya.DebugPanel.enable(),Laya.stage.scaleMode=GameConfig_1.default.scaleMode,Laya.stage.screenMode=GameConfig_1.default.screenMode,Laya.URL.exportSceneToJson=GameConfig_1.default.exportSceneToJson,Laya.stage.bgColor="A7B2C1",(GameConfig_1.default.debug||"true"==Laya.Utils.getQueryString("debug"))&&Laya.enableDebugPanel(),GameConfig_1.default.physicsDebug&&Laya.PhysicsDebugDraw&&Laya.PhysicsDebugDraw.enable(),GameConfig_1.default.stat&&Laya.Stat.show(),Laya.alertGlobalError=!0,Laya.ResourceVersion.enable("version.json",Laya.Handler.create(this,this.onVersionLoaded),Laya.ResourceVersion.FILENAME_VERSION)}return Main.prototype.onVersionLoaded=function(){Laya.AtlasInfoManager.enable("fileconfig.json",Laya.Handler.create(this,this.onConfigLoaded))},Main.prototype.onConfigLoaded=function(){GameConfig_1.default.startScene&&Laya.Scene.open(GameConfig_1.default.startScene)},Main}())},{"./GameConfig":1}],3:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var GameUI_1=require("./GameUI"),MessageView_1=require("./MessageView"),SoundManager=Laya.SoundManager,GameControl=function(_super){function GameControl(){var _this=_super.call(this)||this;return _this.curTargetCount=-1,_this.isSuccess=!0,_this.started=!1,_this.oldScore=0,_this.oldTime=0,_this._targetQueueList=new Array,_this.maxCount=100,_this._curClickValue=-1,_this._renderIndex=-1,_this._index=-1,_this.scoreMessage=["幼儿园水平","小学生水平","中学生水平","高中生水平","社会人水平","大师"],_this}return __extends(GameControl,_super),Object.defineProperty(GameControl.prototype,"RenderIndex",{get:function(){return this._renderIndex},set:function(value){this._renderIndex=value,this.lock&&-1!=value&&(value>=this._targetQueueList.length?this.OnRenderEffectComplete():this.OnRenderEffect())},enumerable:!0,configurable:!0}),Object.defineProperty(GameControl.prototype,"Index",{get:function(){return this._index},set:function(value){this._index=value,0!=value&&value==this._targetQueueList.length&&this.OnInputValueAllSuccess()},enumerable:!0,configurable:!0}),Object.defineProperty(GameControl.prototype,"ColumnCount",{get:function(){return this._columnCount},set:function(val){this._columnCount!=val&&(GameUI_1.default.instance.ResetPosition(val,this.RowCount),this._columnCount=val)},enumerable:!0,configurable:!0}),GameControl.prototype.Init=function(){this.InitData(),this.lifeTime=6e6,this._renderGapTime=500,this.Reset()},GameControl.prototype.InitData=function(){this.oldScore=Number(Laya.LocalStorage.getItem("score")),this.oldTime=Number(Laya.LocalStorage.getItem("time"))},GameControl.prototype.Reset=function(){this.ColumnCount=2,this.RowCount=2,this.OnInitNextTeamData(),this.started=!0},GameControl.prototype.OnStartRender=function(){this._targetQueueList=this.randUnique(1,this.curTargetCount),this._renderTime=.1;for(var tmp_str="",index=0;index<this._targetQueueList.length;index++)tmp_str+=this._targetQueueList[index]-1+",";GameUI_1.default.instance.lblInput.text="Queue："+tmp_str},GameControl.prototype.OnInitTargetCount=function(){this._changeFlag?this.ColumnCount++:this.RowCount++},GameControl.prototype.OnInitNextTeamData=function(){this.lock=!0,this.Index=0,this._startTime=Date.now(),this._renderTime=0,this.RenderIndex=-1,this.curTargetCount=this.ColumnCount*this.RowCount,this.maxTime=2500*this.curTargetCount,console.log("===="+this.maxTime),GameUI_1.default.instance.OnRenderItemBox(this.curTargetCount,this.ColumnCount,this.RowCount),this._targetQueueList.splice(0,this._targetQueueList.length),this.OnStartRender()},GameControl.prototype.SetCurClickValue=function(val){this._curClickValue=val,SoundManager.playMusic("sound/destroy.wav",1),this.lock?console.log("====lock==== "):(console.log("====Index==== "+this.Index+" value "+val),this._targetQueueList[this.Index]==val+1?this.OnSuccess():this.OnError())},GameControl.prototype.OnSuccess=function(){console.log("====OnSuccess==== "),++this.Index},GameControl.prototype.OnError=function(){GameUI_1.default.instance.OnError(),console.log("====OnError==== ");var i=0,val=this.ColumnCount*this.RowCount;i=val>=81?5:val>=64?4:val>=49?3:val>=36?2:val>=16?1:0;var lblMsg=this.scoreMessage[i];MessageView_1.default.instance.ShowMessage("提示:",lblMsg)},GameControl.prototype.RandomInt=function(start,before){return start+Math.floor(Math.random()*(before-start))},GameControl.prototype.onUpdate=function(){this.isSuccess&&this.started&&(this.OnTimeUpdate(),this.OnRenderUpdate())},GameControl.prototype.OnTimeUpdate=function(){GameUI_1.default.instance.OnTimeUpdate(Date.now()-this._startTime)},GameControl.prototype.OnRenderUpdate=function(){if(this.lock){var now=Date.now();this._renderTime>0&&now>this._renderTime&&(++this.RenderIndex,this._renderTime=now+this._renderGapTime)}},GameControl.prototype.OnRenderEffect=function(){var index=this._targetQueueList[this.RenderIndex];GameUI_1.default.instance.OnSelectItem(index)},GameControl.prototype.OnRenderEffectComplete=function(){this.lock=!1,GameUI_1.default.instance.OnHideSelectItem()},GameControl.prototype.OnInputValueAllSuccess=function(){this.OnInitTargetCount(),this.OnInitNextTeamData(),this._changeFlag=!this._changeFlag},GameControl.prototype.startGame=function(){this.started=!0,this.Init()},GameControl.prototype.stopGame=function(){},GameControl.prototype.randUnique=function(start,end){for(var allNums=new Array,i=start,k=0;i<=end;i++,k++)allNums[k]=i;return allNums.sort(function(){return.5-Math.random()}),allNums},GameControl}(Laya.Script);exports.default=GameControl},{"./GameUI":4,"./MessageView":6}],4:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var layaMaxUI_1=require("./../ui/layaMaxUI"),GameControl_1=require("./GameControl"),ItemBox_1=require("./ItemBox"),Tween=Laya.Tween,GlowFilter=Laya.GlowFilter,MessageView_1=require("./MessageView"),GameUI=function(_super){function GameUI(){var _this=_super.call(this)||this;return _this.itemBoxArray=new Array,GameUI.instance=_this,_this.selectGlowFilter=new GlowFilter("#ffff00",10,0,0),_this.errorGlowFilter=new GlowFilter("#FF0000",10,0,0),Laya.MouseManager.multiTouchEnabled=!1,_this.btnRank.on(Laya.Event.CLICK,_this,_this.OnRenderRankView),_this}return __extends(GameUI,_super),GameUI.prototype.onEnable=function(){this._control=this.getComponent(GameControl_1.default),this.Init(),this.startGame()},GameUI.prototype.Init=function(){this.lblScore.text="Score: ",this.lblTime.text="Time:"},GameUI.prototype.OnRenderItemBox=function(count,column,row){Math.max(0,count-this.itemBoxArray.length);for(var index=this.itemBoxArray.length;index<count;index++)this.createBox(index);for(var i=0;i<this.itemBoxArray.length;i++){var item=this.itemBoxArray[i];item.Flag=!1,i>count-1?item.root.visible=!1:(item.root.visible=!0,Tween.from(item.root,{scaleX:.5,scaleY:.5},100),Tween.to(item.root,{scaleX:1,scaleY:1},100))}this.ResetPosition(column,row)},GameUI.prototype.OnSelectItem=function(index){this.selectFlag.visible||(this.selectFlag.visible=!0);var i=index-1;Tween.from(this.selectFlag,{scaleX:.5,scaleY:.5},100),Tween.to(this.selectFlag,{scaleX:1,scaleY:1},100);var item=this.itemBoxArray[i];this.selectFlag.x=item.root.x,this.selectFlag.y=item.root.y,this.selectFlag.zOrder=-10,this.selectFlag.filters=[this.selectGlowFilter]},GameUI.prototype.OnHideSelectItem=function(){this.selectFlag.visible=!1},GameUI.prototype.createBox=function(index){var box=Laya.Pool.getItemByCreateFun("itemBox",this._control.itemBox.create,this._control.itemBox);GameUI.instance.itemBoxs.addChild(box);var item=box.getComponent(ItemBox_1.default);item.lblIndex.text=index+"",item.index=index,item.img.rotation=this._control.RandomInt(0,360),this.itemBoxArray[index]=item},GameUI.prototype.OnClickItem=function(index){this._control.SetCurClickValue(index)},GameUI.prototype.ResetPosition=function(column,row){for(var x=0,y=0,tmp_x=(this.itemBoxArray.length,320-33*(column-1)),tmp_y=320-33*(row-1),i=0;i<this.itemBoxArray.length;i++){var item=this.itemBoxArray[i],_new_x=tmp_x+66*x,_new_y=tmp_y+66*y;item.root.x=_new_x,item.root.y=_new_y,++x>=column&&column>0&&(x=0,++y)}},GameUI.prototype.OnTimeUpdate=function(times){if(times>this._control.maxTime)return MessageView_1.default.instance.ShowMessage("提示","时间到！"),void(this._control.started=!1);var minutes=Math.floor(times/6e4),seconds=Math.floor((times-6e4*minutes)/1e3),ms=Math.floor((times-6e4*minutes-1e3*seconds)/10);this.lblTime.text="Time:"+(minutes<10?"0"+minutes:minutes)+":"+(seconds<10?"0"+seconds:seconds)+":"+(ms<10?"0"+ms:ms),times+1e4>this._control.lifeTime&&(this.lblTime.color="FF0000")},GameUI.prototype.OnRenderRankView=function(){Laya.Browser.onMiniGame&&Laya.loader.load(["res/atlas/test.atlas"],Laya.Handler.create(null,function(){Laya.MiniAdpter.sendAtlasToOpenDataContext("res/atlas/test.atlas"),Laya.Browser.window.wx.getOpenDataContext().postMessage({action:"ranking"})}))},GameUI.prototype.OnError=function(){this.selectFlag.filters=[this.errorGlowFilter]},GameUI.prototype.OnReset=function(){this._control.Reset()},GameUI.prototype.startGame=function(){this._control.startGame()},GameUI.prototype.stopGame=function(){this._control.stopGame()},GameUI}(layaMaxUI_1.ui.test.TestSceneUI);exports.default=GameUI},{"./../ui/layaMaxUI":7,"./GameControl":3,"./ItemBox":5,"./MessageView":6}],5:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var GameUI_1=require("./GameUI"),Tween=Laya.Tween,ItemBox=function(_super){function ItemBox(){return _super.call(this)||this}return __extends(ItemBox,_super),Object.defineProperty(ItemBox.prototype,"Flag",{get:function(){return this._flag},set:function(value){this._flag=value,this.ChangeStyle(value?"test/img2.png":"test/img1.png")},enumerable:!0,configurable:!0}),ItemBox.prototype.onAwake=function(){this.Init(),this.Flag=!1},ItemBox.prototype.Init=function(){this.root=this.owner,this.owner.on(Laya.Event.CLICK,this,this.onItemClick),this.lblIndex=this.owner.getChildByName("lblIndex"),this.img=this.owner.getChildByName("img")},ItemBox.prototype.ChangeStyle=function(textureUrl){this.img.graphics.clear();var texture=Laya.loader.getRes(textureUrl);this.img.graphics.drawTexture(texture,0,0,64,64)},ItemBox.prototype.onItemClick=function(){this.Flag=!0,Tween.from(this.root,{scaleX:.8,scaleY:.8},100),Tween.to(this.root,{scaleX:1,scaleY:1},100),GameUI_1.default.instance.OnClickItem(this.index)},ItemBox.prototype.onDisable=function(){Laya.Pool.recover("itemBox",this.owner)},ItemBox}(Laya.Script);exports.default=ItemBox},{"./GameUI":4}],6:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var GameUI_1=require("./GameUI"),Tween=Laya.Tween,Ease=Laya.Ease,MessageView=function(_super){function MessageView(){var _this=_super.call(this)||this;return MessageView.instance=_this,_this}return __extends(MessageView,_super),MessageView.prototype.onAwake=function(){this.Init()},MessageView.prototype.Init=function(){this.root=this.owner,this.owner.on(Laya.Event.CLICK,this,this.onBgClick),this.lblTitle=this.owner.getChildByName("lblTitle"),this.lblMsg=this.owner.getChildByName("lblMsg"),this.btnOk=this.owner.getChildByName("btnOk"),this.btnOk.on(Laya.Event.CLICK,this,this.onBtnClick)},MessageView.prototype.ShowMessage=function(title,msg){this.root.visible=!0,Tween.from(this.root,{scaleX:.1,scaleY:.1},100),Tween.to(this.root,{scaleX:1,scaleY:1},100),this.lblTitle.text=title,this.lblMsg.text=msg},MessageView.prototype.onBgClick=function(){Tween.from(this.root,{scaleX:1,scaleY:1},100),Tween.to(this.root,{scaleX:0,scaleY:0},100,Ease.bounceIn,Laya.Handler.create(this,function(){this.root.visible=!1,GameUI_1.default.instance.OnReset()}))},MessageView.prototype.onBtnClick=function(){Tween.from(this.root,{scaleX:1,scaleY:1},100),Tween.to(this.root,{scaleX:0,scaleY:0},100,Ease.bounceIn,Laya.Handler.create(this,function(){this.root.visible=!1,GameUI_1.default.instance.OnReset()}))},MessageView}(Laya.Script);exports.default=MessageView},{"./GameUI":4}],7:[function(require,module,exports){"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var REG=Laya.ClassUtils.regClass;!function(ui){!function(test){var TestSceneUI=function(_super){function TestSceneUI(){return _super.call(this)||this}return __extends(TestSceneUI,_super),TestSceneUI.prototype.createChildren=function(){_super.prototype.createChildren.call(this),this.loadScene("test/TestScene")},TestSceneUI}(Laya.Scene);test.TestSceneUI=TestSceneUI,REG("ui.test.TestSceneUI",TestSceneUI)}(ui.test||(ui.test={}))}(exports.ui||(exports.ui={}))},{}]},{},[2]);